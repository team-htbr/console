<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="shared-styles.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-input/paper-input-error.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-behavior/paper-dialog-behavior.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-radio-group/paper-radio-group.html">
<link rel="import" href="../bower_components/google-map/google-map.html">
<link rel="import" href="../bower_components/google-map/google-map-marker.html">
<link rel="import" href="../bower_components/google-apis/google-maps-api.html">
<link rel="import" href="../bower_components/vaadin-combo-box/vaadin-combo-box.html">
<link rel="import" href="../bower_components/vaadin-grid/vaadin-grid.html">
<link rel="import" href="../bower_components/vaadin-grid/vaadin-grid-sorter.html ">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../bower_components/vaadin-date-picker/vaadin-date-picker.html">


<dom-module id="my-locations">
  <template>
    <style include="shared-styles">
      :host {
				--app-primary-color: #ed1c24;
				--app-secondary-color: #666666;
				--light-background: #f5f5f5;
				display: block;
				padding: 20px;
				--paper-input-container-focus-color: var(--app-primary-color);
				--paper-input-container-invalid-color: var(--app-primary-color);
				--paper-radio-button-checked-color: var(--app-primary-color);
				--paper-radio-button-unchecked-color: var(--app-secondary-color);
				--primary-color: var(--app-primary-color);
				--light-primary-color: var(--light-background);
			}
      
      .no-margin {
				margin: 0;
			}

			.paper-map {
				height: 420px;
			}

			.paper-mat-title {
				background-color: var(--light-background);
				border-radius: 1px 1px 0 0;
				padding: 16px 0;
				box-shadow: 0 -1px 0 rgba(0,0,0,0.12) inset;
			}
      
      paper-material {
        background-color: #fff;
        margin-top: 12px;
        border-radius: 1px;
      }

      .paper-mat-title p {
        width: 65%;
        margin: 0 auto;
        overflow: hidden;
      }
      
      .add-location {
				padding-bottom: 30px;
			}

      form {
        width: 65%;
        margin: 0 auto;
        overflow: hidden;
        padding-top: 16px;
      }

      paper-button {
        background-color: var(--light-background);
      }

      paper-button:active {
        background-color: var(--app-primary-color);
      }
      
			#locationBtn {
				float: right;
				margin-right: 3px;
				margin-bottom: 3px;
				color: #ffffff;
				background-color: var(--app-primary-color);
			}

			#locationBtn[disabled] {
				background-color: #eaeaea;
				color: #a8a8a8;
			}

      paper-radio-button:first-child {
        padding-left: 0;
      }

			#toastContainer {
				margin-top: 16px;
				height: 30px;
			}
      
      vaadin-date-picker {
				width: 48%;
			}

			.dateContainer {
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				margin-bottom: 16px;
				display: none;
			}


	  .functions {
		  text-align: right;
	  }

	  div#indicators {
		  display: none;
	  }

	  vaadin-grid vaadin-grid-sorter {
	  	  --vaadin-grid-sorter-arrow: {
			  display: none !important;
		  };
      }

	  paper-dialog {
		  width: 60%;
		  left: 20%;
	  }

	  .details {
        padding: 10px;
        margin: 10px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        box-shadow: 0 2px 2px 0 rgba(0, 0, 0, 0.14);
        font-size: 20px;
      }

    </style>

	<google-maps-api id="mapsAPI" api-key="AIzaSyDHQfVnj8-EI6WHLkXNl1kJzLv4NRH8Bio"></google-maps-api>
		<paper-material class="paper-map no-margin">
			<google-map id="map" latitude="{{latitude}}" longitude="{{longitude}}" zoom="{{zoom}}" api-key="AIzaSyDHQfVnj8-EI6WHLkXNl1kJzLv4NRH8Bio" click-events="true"
			single-info-window="true" google-map-click="{{markerClicked}}" disable-default-ui></google-map>
		</paper-material>
    
    <paper-material>
		<vaadin-grid id="grid" on-active-item-changed="_onActiveItemChanged" items="{{items}}" active-item="{{activeItem}}" multi-sort="true">
			<template class="row-details">
				<div class="details">

				</div>
			</template>
			<vaadin-grid-column>
				<template class="header">
					<vaadin-grid-sorter path="name">Locatie</vaadin-grid-sorter>
				</template>
				<template>[[item.name]]</template>
			</vaadin-grid-column>

			<vaadin-grid-column>
				<template class="header">
					<vaadin-grid-sorter path="street">Straat</vaadin-grid-sorter>
				</template>
				<template>[[item.street]] [[item.streetNumber]]</template>
			</vaadin-grid-column>

			<vaadin-grid-column>
				<template class="header">
					<vaadin-grid-sorter path="city">Regio</vaadin-grid-sorter>
				</template>
				<template>[[item.city]]</template>
			</vaadin-grid-column>

			<vaadin-grid-column class="functions-column">
				<template class="header"></template>
					<template>
						<div class="functions">
							<paper-icon-button class="edit" src="../images/ic_delete_grey.png" on-tap="_removeLocation"></paper-icon-button>
							<paper-icon-button src="../images/ic_edit_grey.png" on-tap="_editLocation"></paper-icon-button>
						</div>
					</template>
			</vaadin-grid-column>
		</vaadin-grid>
	</paper-material>

		<paper-material class="add-location">
			<div class="paper-mat-title"><p>Voeg een donorcentrum toe.</p></div>
			<form is="iron-form" method="get" action="/" id="locationForm">
				<paper-input auto-validate error-message="Gelieve naam van de locatie in te geven." name="location-name" label="Naam" id="name" required></paper-input>
				<paper-input auto-validate error-message="Gelieve straatnaam van de locatie in te geven." name="location-street" label="Straat" id="street" required></paper-input>
				<paper-input auto-validate error-message="Gelieve huisnummer van de locatie in te geven." name="location-number" label="Nummer" id="streetNumber" required></paper-input>
				<paper-input auto-validate error-message="Gelieve stad/dorp van de locatie in te geven." name="location-city" label="Gemeente" id="city" required></paper-input>
				<br>
				<paper-radio-group class="item" selected="fixed">
					<paper-radio-button name="fixed" on-tap="_on_tap_fixed" value="false">Vast</paper-radio-button>
					<paper-radio-button name="mobile" on-tap="_on_tap_mobile" value="true">Mobiel</paper-radio-button>
				</paper-radio-group>
				<div class="dateContainer">
					<vaadin-date-picker class="item" id="startDatePicker" label="Begindatum"></vaadin-date-picker>
					<vaadin-date-picker class="item" id="endDatePicker" label="Einddatum"></vaadin-date-picker>
				</div>
				<paper-button id="locationBtn" disabled raised on-tap="submit" class="no-margin">Voeg toe</paper-button>
				<div class="output"></div>
			</form>
		</paper-material>

		<div id="toastContainer">
			<paper-toast id="toastSuccess" class="fit-bottom" text="Locatie is toegevoegd."></paper-toast>
		</div>
  </template>
  <script src="../bower_components/geofire/dist/geofire.min.js"></script>
  <script src="../bower_components/firebase/firebase.js"></script>
  <script src="js/maptest.js"></script>
</dom-module>
